!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@luban-h5/support")):"function"==typeof define&&define.amd?define(["exports","@luban-h5/support"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["lbp-table"]={},e.LubanH5Support)}(this,(function(e,t){"use strict";var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){var t={exports:{}};return e(t,t.exports),t.exports}var i=function(e){return e&&e.Math==Math&&e},o=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof r&&r)||function(){return this}()||Function("return this")(),a=function(e){try{return!!e()}catch(t){return!0}},l=!a((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),s={}.propertyIsEnumerable,u=Object.getOwnPropertyDescriptor,c={f:u&&!s.call({1:2},1)?function(e){var t=u(this,e);return!!t&&t.enumerable}:s},f=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},d={}.toString,_=function(e){return d.call(e).slice(8,-1)},h="".split,p=a((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==_(e)?h.call(e,""):Object(e)}:Object,b=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},g=function(e){return p(b(e))},v=function(e){return"object"==typeof e?null!==e:"function"==typeof e},y=function(e,t){if(!v(e))return e;var r,n;if(t&&"function"==typeof(r=e.toString)&&!v(n=r.call(e)))return n;if("function"==typeof(r=e.valueOf)&&!v(n=r.call(e)))return n;if(!t&&"function"==typeof(r=e.toString)&&!v(n=r.call(e)))return n;throw TypeError("Can't convert object to primitive value")},m={}.hasOwnProperty,w=function(e,t){return m.call(e,t)},z=o.document,S=v(z)&&v(z.createElement),E=!l&&!a((function(){return 7!=Object.defineProperty((e="div",S?z.createElement(e):{}),"a",{get:function(){return 7}}).a;var e})),T=Object.getOwnPropertyDescriptor,x={f:l?T:function(e,t){if(e=g(e),t=y(t,!0),E)try{return T(e,t)}catch(r){}if(w(e,t))return f(!c.f.call(e,t),e[t])}},O=function(e){if(!v(e))throw TypeError(String(e)+" is not an object");return e},A=Object.defineProperty,C={f:l?A:function(e,t,r){if(O(e),t=y(t,!0),O(r),E)try{return A(e,t,r)}catch(n){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},j=l?function(e,t,r){return C.f(e,t,f(1,r))}:function(e,t,r){return e[t]=r,e},W=function(e,t){try{j(o,e,t)}catch(r){o[e]=t}return t},M="__core-js_shared__",F=o[M]||W(M,{}),L=Function.toString;"function"!=typeof F.inspectSource&&(F.inspectSource=function(e){return L.call(e)});var P,N,H,I,k=F.inspectSource,q=o.WeakMap,R="function"==typeof q&&/native code/.test(k(q)),D=n((function(e){(e.exports=function(e,t){return F[e]||(F[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.7.0",mode:"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})})),$=0,G=Math.random(),B=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++$+G).toString(36)},K=D("keys"),U={},V=o.WeakMap;if(R){var Y=F.state||(F.state=new V),J=Y.get,Q=Y.has,X=Y.set;P=function(e,t){return t.facade=e,X.call(Y,e,t),t},N=function(e){return J.call(Y,e)||{}},H=function(e){return Q.call(Y,e)}}else{var Z=K[I="state"]||(K[I]=B(I));U[Z]=!0,P=function(e,t){return t.facade=e,j(e,Z,t),t},N=function(e){return w(e,Z)?e[Z]:{}},H=function(e){return w(e,Z)}}var ee,te,re={set:P,get:N,has:H,enforce:function(e){return H(e)?N(e):P(e,{})},getterFor:function(e){return function(t){var r;if(!v(t)||(r=N(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return r}}},ne=n((function(e){var t=re.get,r=re.enforce,n=String(String).split("String");(e.exports=function(e,t,i,a){var l,s=!!a&&!!a.unsafe,u=!!a&&!!a.enumerable,c=!!a&&!!a.noTargetGet;"function"==typeof i&&("string"!=typeof t||w(i,"name")||j(i,"name",t),(l=r(i)).source||(l.source=n.join("string"==typeof t?t:""))),e!==o?(s?!c&&e[t]&&(u=!0):delete e[t],u?e[t]=i:j(e,t,i)):u?e[t]=i:W(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&t(this).source||k(this)}))})),ie=o,oe=function(e){return"function"==typeof e?e:void 0},ae=function(e,t){return arguments.length<2?oe(ie[e])||oe(o[e]):ie[e]&&ie[e][t]||o[e]&&o[e][t]},le=Math.ceil,se=Math.floor,ue=function(e){return isNaN(e=+e)?0:(e>0?se:le)(e)},ce=Math.min,fe=function(e){return e>0?ce(ue(e),9007199254740991):0},de=Math.max,_e=Math.min,he=function(e,t){var r=ue(e);return r<0?de(r+t,0):_e(r,t)},pe=function(e){return function(t,r,n){var i,o=g(t),a=fe(o.length),l=he(n,a);if(e&&r!=r){for(;a>l;)if((i=o[l++])!=i)return!0}else for(;a>l;l++)if((e||l in o)&&o[l]===r)return e||l||0;return!e&&-1}},be={includes:pe(!0),indexOf:pe(!1)}.indexOf,ge=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"].concat("length","prototype"),ve={f:Object.getOwnPropertyNames||function(e){return function(e,t){var r,n=g(e),i=0,o=[];for(r in n)!w(U,r)&&w(n,r)&&o.push(r);for(;t.length>i;)w(n,r=t[i++])&&(~be(o,r)||o.push(r));return o}(e,ge)}},ye={f:Object.getOwnPropertySymbols},me=ae("Reflect","ownKeys")||function(e){var t=ve.f(O(e)),r=ye.f;return r?t.concat(r(e)):t},we=function(e,t){for(var r=me(t),n=C.f,i=x.f,o=0;o<r.length;o++){var a=r[o];w(e,a)||n(e,a,i(t,a))}},ze=/#|\.prototype\./,Se=function(e,t){var r=Te[Ee(e)];return r==Oe||r!=xe&&("function"==typeof t?a(t):!!t)},Ee=Se.normalize=function(e){return String(e).replace(ze,".").toLowerCase()},Te=Se.data={},xe=Se.NATIVE="N",Oe=Se.POLYFILL="P",Ae=Se,Ce=x.f,je=function(e,t){var r,n,i,a,l,s=e.target,u=e.global,c=e.stat;if(r=u?o:c?o[s]||W(s,{}):(o[s]||{}).prototype)for(n in t){if(a=t[n],i=e.noTargetGet?(l=Ce(r,n))&&l.value:r[n],!Ae(u?n:s+(c?".":"#")+n,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;we(a,i)}(e.sham||i&&i.sham)&&j(a,"sham",!0),ne(r,n,a,e)}},We=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Me=function(e){return Object(b(e))},Fe=Array.isArray||function(e){return"Array"==_(e)},Le=!!Object.getOwnPropertySymbols&&!a((function(){return!String(Symbol())})),Pe=Le&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Ne=D("wks"),He=o.Symbol,Ie=Pe?He:He&&He.withoutSetter||B,ke=function(e){return w(Ne,e)||(Le&&w(He,e)?Ne[e]=He[e]:Ne[e]=Ie("Symbol."+e)),Ne[e]},qe=ke("species"),Re=function(e,t){var r;return Fe(e)&&("function"!=typeof(r=e.constructor)||r!==Array&&!Fe(r.prototype)?v(r)&&null===(r=r[qe])&&(r=void 0):r=void 0),new(void 0===r?Array:r)(0===t?0:t)},De=[].push,$e=function(e){var t=1==e,r=2==e,n=3==e,i=4==e,o=6==e,a=5==e||o;return function(l,s,u,c){for(var f,d,_=Me(l),h=p(_),b=function(e,t,r){if(We(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}(s,u,3),g=fe(h.length),v=0,y=c||Re,m=t?y(l,g):r?y(l,0):void 0;g>v;v++)if((a||v in h)&&(d=b(f=h[v],v,_),e))if(t)m[v]=d;else if(d)switch(e){case 3:return!0;case 5:return f;case 6:return v;case 2:De.call(m,f)}else if(i)return!1;return o?-1:n||i?i:m}},Ge={forEach:$e(0),map:$e(1),filter:$e(2),some:$e(3),every:$e(4),find:$e(5),findIndex:$e(6)},Be=ae("navigator","userAgent")||"",Ke=o.process,Ue=Ke&&Ke.versions,Ve=Ue&&Ue.v8;Ve?te=(ee=Ve.split("."))[0]+ee[1]:Be&&(!(ee=Be.match(/Edge\/(\d+)/))||ee[1]>=74)&&(ee=Be.match(/Chrome\/(\d+)/))&&(te=ee[1]);var Ye=te&&+te,Je=ke("species"),Qe=function(e){return Ye>=51||!a((function(){var t=[];return(t.constructor={})[Je]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Xe=Object.defineProperty,Ze={},et=function(e){throw e},tt=function(e,t){if(w(Ze,e))return Ze[e];t||(t={});var r=[][e],n=!!w(t,"ACCESSORS")&&t.ACCESSORS,i=w(t,0)?t[0]:et,o=w(t,1)?t[1]:void 0;return Ze[e]=!!r&&!a((function(){if(n&&!l)return!0;var e={length:-1};n?Xe(e,1,{enumerable:!0,get:et}):e[1]=1,r.call(e,i,o)}))},rt=Ge.map,nt=Qe("map"),it=tt("map");je({target:"Array",proto:!0,forced:!nt||!it},{map:function(e){return rt(this,e,arguments.length>1?arguments[1]:void 0)}});var ot,at,lt=function(e){return function(t,r,n,i){We(r);var o=Me(t),a=p(o),l=fe(o.length),s=e?l-1:0,u=e?-1:1;if(n<2)for(;;){if(s in a){i=a[s],s+=u;break}if(s+=u,e?s<0:l<=s)throw TypeError("Reduce of empty array with no initial value")}for(;e?s>=0:l>s;s+=u)s in a&&(i=r(i,a[s],s,o));return i}},st={left:lt(!1),right:lt(!0)},ut="process"==_(o.process),ct=st.left,ft=!!(at=[]["reduce"])&&a((function(){at.call(null,ot||function(){throw 1},1)})),dt=tt("reduce",{1:0});je({target:"Array",proto:!0,forced:!ft||!dt||!ut&&Ye>79&&Ye<83},{reduce:function(e){return ct(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var _t=function(e,t,r){var n=y(t);n in e?C.f(e,n,f(0,r)):e[n]=r},ht=Qe("slice"),pt=tt("slice",{ACCESSORS:!0,0:0,1:2}),bt=ke("species"),gt=[].slice,vt=Math.max;je({target:"Array",proto:!0,forced:!ht||!pt},{slice:function(e,t){var r,n,i,o=g(this),a=fe(o.length),l=he(e,a),s=he(void 0===t?a:t,a);if(Fe(o)&&("function"!=typeof(r=o.constructor)||r!==Array&&!Fe(r.prototype)?v(r)&&null===(r=r[bt])&&(r=void 0):r=void 0,r===Array||void 0===r))return gt.call(o,l,s);for(n=new(void 0===r?Array:r)(vt(s-l,0)),i=0;l<s;l++,i++)l in o&&_t(n,i,o[l]);return n.length=i,n}});var yt=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n};var mt=function(e){if(Array.isArray(e))return yt(e)};var wt=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)};var zt=function(e,t){if(e){if("string"==typeof e)return yt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yt(e,t):void 0}};var St=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var Et=function(e){return mt(e)||wt(e)||zt(e)||St()};let Tt=null;let xt=null;function Ot(e,t={}){let r=document.createElement(e);return Object.keys(t).forEach((e=>{r[e]=t[e]})),r}function At(e,t,r){return(window.getComputedStyle(e,r||null)||{display:"none"})[t]}function Ct(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};let t=e;for(;t!==document;){if("none"===At(t,"display"))return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}let jt=0,Wt=null;function Mt(e,t){if(e.__resize_mutation_handler__||(e.__resize_mutation_handler__=Ft.bind(e)),!e.__resize_listeners__)if(e.__resize_listeners__=[],window.ResizeObserver){let{offsetWidth:t,offsetHeight:r}=e,n=new ResizeObserver((()=>{(e.__resize_observer_triggered__||(e.__resize_observer_triggered__=!0,e.offsetWidth!==t||e.offsetHeight!==r))&&Pt(e)})),{detached:i,rendered:o}=Ct(e);e.__resize_observer_triggered__=!1===i&&!1===o,e.__resize_observer__=n,n.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){Pt(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(jt||(Wt=function(e){var t=document.createElement("style");return t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}('.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}')),function(e){let t=At(e,"position");t&&"static"!==t||(e.style.position="relative");e.__resize_old_position__=t,e.__resize_last__={};let r=Ot("div",{className:"resize-triggers"}),n=Ot("div",{className:"resize-expand-trigger"}),i=Ot("div"),o=Ot("div",{className:"resize-contract-trigger"});n.appendChild(i),r.appendChild(n),r.appendChild(o),e.appendChild(r),e.__resize_triggers__={triggers:r,expand:n,expandChild:i,contract:o},Nt(e),e.addEventListener("scroll",Lt,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}(e),e.__resize_rendered__=Ct(e).rendered,window.MutationObserver){let t=new MutationObserver(e.__resize_mutation_handler__);t.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=t}e.__resize_listeners__.push(t),jt++}function Ft(){let{rendered:e,detached:t}=Ct(this);e!==this.__resize_rendered__&&(!t&&this.__resize_triggers__&&(Nt(this),this.addEventListener("scroll",Lt,!0)),this.__resize_rendered__=e,Pt(this))}function Lt(){var e;Nt(this),this.__resize_raf__&&function(e){xt||(xt=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)}).bind(window)),xt(e)}(this.__resize_raf__),this.__resize_raf__=(e=()=>{let e=function(e){let{width:t,height:r}=e.__resize_last__,{offsetWidth:n,offsetHeight:i}=e;return n!==t||i!==r?{width:n,height:i}:null}(this);e&&(this.__resize_last__=e,Pt(this))},Tt||(Tt=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return setTimeout(e,16)}).bind(window)),Tt(e))}function Pt(e){e&&e.__resize_listeners__&&e.__resize_listeners__.forEach((t=>{t.call(e,e)}))}function Nt(e){let{expand:t,expandChild:r,contract:n}=e.__resize_triggers__,{scrollWidth:i,scrollHeight:o}=n,{offsetWidth:a,offsetHeight:l,scrollWidth:s,scrollHeight:u}=t;n.scrollLeft=i,n.scrollTop=o,r.style.width=a+1+"px",r.style.height=l+1+"px",t.scrollLeft=s,t.scrollTop=u}var Ht={name:"lbp-table",data:function(){return{mainTableWrapperEle:null,mainTableEle:null,fixedTableWrapperEle:null,fixedTableEle:null}},props:{width:{default:120},height:{default:120},theme:t.Input({label:"主题"}),columnWidth:t.InputNumber({label:"每列宽度(px)"}),freezeCount:t.InputNumber({label:"冻结列数(px)"})},watch:{freezeCount:function(){var e=this;setTimeout((function(){e.setFixedTableStyle()}),100)}},render:function(){var e=this,t=arguments[0],r=function(e){return t("td",[t("div",{class:"cell"},[e])])},n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=n.length?n[0]:[],l=a.length;return t("table",{class:i,style:o},[t("colgroup",[Et(Array(l)).map((function(r,n){return t("col",{style:{width:e.columnWidth+"px"}})}))]),t("tbody",[n.map((function(e){return t("tr",[e.map(r)])}))])])};return t("div",{class:["lbp-table",this.theme],ref:"lbpTable"},[t("div",{class:"main-table-wrapper"},[n(this.dataset)]),t("div",{class:"fixed-table-wrapper",directives:[{name:"show",value:"freezeCount"}]},[n(this.dataset,"left-table")])])},methods:{getFixedColsWidth:function(){return function(){var e=arguments.length>1?arguments[1]:void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((function(t){return t[e]})).reduce((function(e,t){return e+t}),0)}([].slice.apply(this.mainTableEle.querySelectorAll("tr:first-child > td")).slice(0,+this.freezeCount),"offsetWidth")},setFixedTableStyle:function(){this.fixedTableWrapperEle.style.width="".concat(this.getFixedColsWidth(),"px"),this.fixedTableWrapperEle.style.height="calc(100% - ".concat(this.mainTableWrapperEle.offsetHeight-this.mainTableWrapperEle.scrollHeight,"px)")},setTableWidth:function(){var e=this.$el.parentNode.style.width;this.fixedTableEle.style.width=this.mainTableEle.style.width=e},initElements:function(){var e=this.$el;this.mainTableWrapperEle=e.querySelector(".main-table-wrapper"),this.mainTableEle=e.querySelector(".main-table-wrapper > table"),this.fixedTableWrapperEle=e.querySelector(".fixed-table-wrapper"),this.fixedTableEle=e.querySelector(".left-table")},__resizeHandler:function(){this.setTableWidth(),this.freezeCount&&this.setFixedTableStyle()}},mounted:function(){this.initElements(),this.setTableWidth(),this.setFixedTableStyle(),Mt(this.$refs.lbpTable,this.__resizeHandler)},destroy:function(){!function(e,t){let r=e.__resize_listeners__;if(r){if(t&&r.splice(r.indexOf(t),1),!r.length||!t){if(e.detachEvent&&e.removeEventListener)return e.detachEvent("onresize",e.__resize_legacy_resize_handler__),void document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",Lt),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--jt&&Wt&&Wt.parentNode.removeChild(Wt)}}(this.$el,this.__resizeHandler)}};e.default=Ht,Object.defineProperty(e,"__esModule",{value:!0})}));
